package javadev.jdbctutorial;

import java.sql.*;
public class CallableStatement02 {

	public static void main(String[] args) throws ClassNotFoundException, SQLException {
		
		Class.forName("oracle.jdbc.driver.OracleDriver");
		
		Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521/xe", "hr", "oracle");
		
		Statement st = con.createStatement();
		
		//Create a procedure to find the minimum one of 2 numbers
		
		String sql1 = "CREATE OR REPLACE PROCEDURE findMin(x IN NUMBER, y IN NUMBER, z OUT NUMBER) IS\r\n"
				+ "BEGIN\r\n"
				+ "    IF x<y THEN\r\n"
				+ "       z :=x;\r\n"
				+ "    ELSE \r\n"
				+ "       z :=y; \r\n"
				+ "    END IF;\r\n"
				+ "END;";
		
		st.execute(sql1);
		System.out.println("procedure is created ");
		
		CallableStatement cst1 = con.prepareCall("{call findMin(?, ?, ? )}");
		cst1.setInt(1, 13);
		cst1.setInt(2, 25);
		cst1.registerOutParameter(3, Types.INTEGER);
		
		cst1.execute();
		
		System.out.println("The minimim of " + cst1.getInt(1) + "and" + cst1.getInt(2) + "is" + cst1.getInt(3));
		
	}

}
